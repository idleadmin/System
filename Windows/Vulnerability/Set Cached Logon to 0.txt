# Define the registry path
$regPath = "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon"

# Check if the CachedLogonsCount value exists
$cachedLogonsCount = Get-ItemProperty -Path $regPath -Name CachedLogonsCount -ErrorAction SilentlyContinue

if ($cachedLogonsCount) {
    # If CachedLogonsCount is already 0, stop the script
    if ($cachedLogonsCount.CachedLogonsCount -eq "0") {
        Write-Host "CachedLogonsCount is already set to 0. No changes needed."
        exit
    } else {
        # Update the CachedLogonsCount value to 0
        Set-ItemProperty -Path $regPath -Name CachedLogonsCount -Value "0"
        Write-Host "CachedLogonsCount value updated to 0."
    }
} else {
    # Create the CachedLogonsCount entry and set it to 0
    New-ItemProperty -Path $regPath -Name CachedLogonsCount -Value "0" -PropertyType String
    Write-Host "CachedLogonsCount value created and set to 0."
}
